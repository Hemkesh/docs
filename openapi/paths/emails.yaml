# Emails API Endpoints

/accounts/{account_id}/emails:
  get:
    operationId: listEmails
    summary: List emails
    description: |
      Retrieve paginated emails associated with your account.
      Email content is excluded from list queries for performance;
      use the single email endpoint to get full content.
    tags:
      - Emails
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
      - $ref: '#/components/parameters/PageParam'
      - $ref: '#/components/parameters/LimitParam'
      - $ref: '#/components/parameters/SortOrderParam'
      - $ref: '#/components/parameters/SearchParam'
      - name: sort_by
        in: query
        schema:
          type: string
          enum: [created_at, updated_at]
          default: created_at
      - name: from_email
        in: query
        required: false
        description: Filter by sender email address
        schema:
          type: string
          format: email
      - name: company_id
        in: query
        required: false
        description: Filter emails linked to a specific company
        schema:
          type: string
          format: uuid
      - name: processed
        in: query
        required: false
        description: Filter by processed status
        schema:
          type: boolean
      - name: tag
        in: query
        required: false
        description: Filter by tag
        schema:
          type: string
    responses:
      '200':
        description: List of emails
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailListResponse'
            example:
              success: true
              data:
                emails:
                  - id: "email-uuid-1"
                    account_id: "account-uuid"
                    from_email: "founder@startup.com"
                    subject: "Investment Opportunity - AI Platform"
                    content_preview: "Hi, I wanted to reach out about our Series A..."
                    tags: ["warm-intro"]
                    processed: false
                    attachments_count: 1
                    created_at: "2024-01-15T10:30:00Z"
                pagination:
                  page: 1
                  limit: 20
                  has_next: true
                  has_prev: false
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        $ref: '#/components/responses/NotFoundError'

/accounts/{account_id}/emails/{email_id}:
  get:
    operationId: getEmail
    summary: Get email details
    description: |
      Retrieve a specific email with full content and attachments.
    tags:
      - Emails
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
      - name: email_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Email details with full content
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                data:
                  type: object
                  properties:
                    email:
                      $ref: '#/components/schemas/EmailDetail'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        $ref: '#/components/responses/NotFoundError'

/accounts/{account_id}/emails/{email_id}/attachments:
  get:
    operationId: listEmailAttachments
    summary: List email attachments
    description: Get all attachments for an email with download URLs.
    tags:
      - Emails
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
      - name: email_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: List of attachments
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                data:
                  type: object
                  properties:
                    attachments:
                      type: array
                      items:
                        $ref: '#/components/schemas/EmailAttachment'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        $ref: '#/components/responses/NotFoundError'

/accounts/{account_id}/emails/tags:
  get:
    operationId: listEmailTags
    summary: List available email tags
    description: |
      Get all tags used in emails for this account, with usage counts.
    tags:
      - Emails
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
    responses:
      '200':
        description: List of tags
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailTagsResponse'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
