# Investor Dashboard API Endpoints

/accounts/{account_id}/investor-dashboard:
  get:
    operationId: getInvestorDashboard
    summary: Get investor dashboard
    description: |
      Retrieve the investor dashboard configuration for an account.
      The investor dashboard is a public-facing page that can be shared
      with LPs to show portfolio performance and updates.
    tags:
      - Investor Dashboard
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
    responses:
      '200':
        description: Investor dashboard details
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                data:
                  type: object
                  properties:
                    dashboard:
                      $ref: '#/components/schemas/InvestorDashboard'
            example:
              success: true
              data:
                dashboard:
                  id: "dash-uuid"
                  account_id: "account-uuid"
                  is_active: true
                  password_protected: true
                  short_code: "inv-abc123"
                  dashboard_url: "https://app.useroulette.com/investor/inv-abc123"
                  shared_permissions: ["view_portfolio", "view_metrics"]
                  access_count: 156
                  last_accessed_at: "2024-01-20T14:30:00Z"
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        description: No investor dashboard configured
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    dashboard:
                      type: "null"

  post:
    operationId: createInvestorDashboard
    summary: Create investor dashboard
    description: |
      Create an investor dashboard for the account. Only one dashboard
      can exist per account.
    tags:
      - Investor Dashboard
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
    requestBody:
      required: false
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/InvestorDashboardCreate'
          example:
            password: "lp-access-2024"
            shared_permissions: ["view_portfolio", "view_metrics", "view_updates"]
            is_active: true
    responses:
      '200':
        description: Dashboard created
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                data:
                  type: object
                  properties:
                    dashboard:
                      $ref: '#/components/schemas/InvestorDashboard'
      '400':
        description: Dashboard already exists or invalid request
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '401':
        $ref: '#/components/responses/UnauthorizedError'

  patch:
    operationId: updateInvestorDashboard
    summary: Update investor dashboard
    description: |
      Update investor dashboard settings including password,
      permissions, and active status.
    tags:
      - Investor Dashboard
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/InvestorDashboardUpdate'
          examples:
            deactivate:
              summary: Deactivate dashboard
              value:
                is_active: false
            updatePermissions:
              summary: Update shared permissions
              value:
                shared_permissions: ["view_portfolio", "view_metrics", "download_reports"]
            removePassword:
              summary: Remove password protection
              value:
                password: null
    responses:
      '200':
        description: Dashboard updated
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                data:
                  type: object
                  properties:
                    dashboard:
                      $ref: '#/components/schemas/InvestorDashboard'
      '400':
        $ref: '#/components/responses/BadRequestError'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        $ref: '#/components/responses/NotFoundError'

  delete:
    operationId: deleteInvestorDashboard
    summary: Delete investor dashboard
    description: |
      Delete the investor dashboard. The dashboard URL will immediately
      stop working.
    tags:
      - Investor Dashboard
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
    responses:
      '200':
        description: Dashboard deleted
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                data:
                  type: object
                  properties:
                    message:
                      type: string
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        $ref: '#/components/responses/NotFoundError'

/accounts/{account_id}/investor-dashboard/access-logs:
  get:
    operationId: getInvestorDashboardAccessLogs
    summary: Get dashboard access logs
    description: |
      Retrieve access logs showing who viewed the investor dashboard,
      when, and from where.
    tags:
      - Investor Dashboard
    parameters:
      - $ref: '#/components/parameters/AccountIdParam'
      - $ref: '#/components/parameters/PageParam'
      - $ref: '#/components/parameters/LimitParam'
    responses:
      '200':
        description: Access logs
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                data:
                  type: object
                  properties:
                    access_logs:
                      type: array
                      items:
                        $ref: '#/components/schemas/InvestorDashboardAccessLog'
                    pagination:
                      $ref: '#/components/schemas/Pagination'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        $ref: '#/components/responses/NotFoundError'
